# ChatX Backend

ChatX åç«¯æœåŠ¡ï¼ŒåŸºäº FastAPI æ„å»ºçš„ç°ä»£åŒ–å¾®æœåŠ¡æ¶æ„ï¼Œé›†æˆäº†å¤šç§æ•°æ®å­˜å‚¨å’ŒAIæœåŠ¡ã€‚

## ğŸ—ï¸ æŠ€æœ¯æ ˆ

### æ ¸å¿ƒæ¡†æ¶
- **FastAPI** - ç°ä»£åŒ–çš„ Web API æ¡†æ¶
- **Uvicorn** - ASGI æœåŠ¡å™¨
- **Pydantic** - æ•°æ®éªŒè¯å’Œè®¾ç½®ç®¡ç†
- **SQLAlchemy** - ORM æ¡†æ¶
- **Alembic** - æ•°æ®åº“è¿ç§»å·¥å…·

### æ•°æ®å­˜å‚¨
- **PostgreSQL** - å…³ç³»å‹æ•°æ®åº“
- **Redis** - ç¼“å­˜å’Œä¼šè¯å­˜å‚¨
- **Neo4j** - çŸ¥è¯†å›¾è°±æ•°æ®åº“
- **Weaviate** - å‘é‡æ•°æ®åº“
- **MinIO** - å¯¹è±¡å­˜å‚¨

### å…¶ä»–æœåŠ¡
- **Celery** - å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—
- **JWT** - èº«ä»½éªŒè¯
- **CORS** - è·¨åŸŸèµ„æºå…±äº«
- **SMTPé‚®ä»¶** - å¤šæœåŠ¡å•†é‚®ä»¶å‘é€

## ğŸ—ï¸ é¡¹ç›®æ¶æ„

### ğŸ“‹ DDDåˆ†å±‚æ¶æ„å›¾ (çº¯æ–‡æœ¬)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ğŸŒ æ¥å£å±‚ (Presentation Layer)                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚  â”‚   FastAPI       â”‚    â”‚   Middleware    â”‚    â”‚  System Routes  â”‚                      â”‚
â”‚  â”‚   Routes        â”‚    â”‚   â€¢ Logging     â”‚    â”‚  â€¢ Health       â”‚                      â”‚
â”‚  â”‚   â€¢ Auth API    â”‚    â”‚   â€¢ Tenant      â”‚    â”‚  â€¢ Metrics      â”‚                      â”‚
â”‚  â”‚   â€¢ User API    â”‚    â”‚   â€¢ Security    â”‚    â”‚  â€¢ System Info  â”‚                      â”‚
â”‚  â”‚   â€¢ File API    â”‚    â”‚   â€¢ CORS        â”‚    â”‚                 â”‚                      â”‚
â”‚  â”‚   â€¢ Role API    â”‚    â”‚                 â”‚    â”‚                 â”‚                      â”‚
â”‚  â”‚   â€¢ Permission  â”‚    â”‚                 â”‚    â”‚                 â”‚                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ğŸ“± åº”ç”¨å±‚ (Application Layer)                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚  â”‚ Application     â”‚    â”‚   Middleware    â”‚    â”‚   Use Cases     â”‚                      â”‚
â”‚  â”‚ Services        â”‚    â”‚   â€¢ API Cache   â”‚    â”‚   â€¢ Business    â”‚                      â”‚
â”‚  â”‚ â€¢ User Service  â”‚    â”‚   â€¢ Session     â”‚    â”‚     Logic       â”‚                      â”‚
â”‚  â”‚ â€¢ Email Service â”‚    â”‚   â€¢ Rate Limit  â”‚    â”‚   â€¢ Workflows   â”‚                      â”‚
â”‚  â”‚ â€¢ RBAC Service  â”‚    â”‚   â€¢ Verify      â”‚    â”‚                 â”‚                      â”‚
â”‚  â”‚ â€¢ File Service  â”‚    â”‚                 â”‚    â”‚                 â”‚                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ğŸ¢ é¢†åŸŸå±‚ (Domain Layer)                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚  â”‚ Domain          â”‚    â”‚ Domain          â”‚    â”‚ Initialization  â”‚                      â”‚
â”‚  â”‚ Entities        â”‚    â”‚ Services        â”‚    â”‚ â€¢ RBAC Init     â”‚                      â”‚
â”‚  â”‚ â€¢ User Logic    â”‚    â”‚ â€¢ User Domain   â”‚    â”‚ â€¢ Admin Init    â”‚                      â”‚
â”‚  â”‚ â€¢ Business      â”‚    â”‚ â€¢ RBAC Domain   â”‚    â”‚ â€¢ Permissions   â”‚                      â”‚
â”‚  â”‚   Rules         â”‚    â”‚ â€¢ File Domain   â”‚    â”‚                 â”‚                      â”‚
â”‚  â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                             â”‚
â”‚  â”‚ Repository      â”‚    â”‚ Domain          â”‚                                             â”‚
â”‚  â”‚ Interfaces      â”‚    â”‚ Models          â”‚                                             â”‚
â”‚  â”‚ â€¢ IUserRepo     â”‚    â”‚ â€¢ User Models   â”‚                                             â”‚
â”‚  â”‚ â€¢ IRBACRepo     â”‚    â”‚ â€¢ Tenant Models â”‚                                             â”‚
â”‚  â”‚ â€¢ IFileRepo     â”‚    â”‚ â€¢ File Models   â”‚                                             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ğŸ”§ åŸºç¡€è®¾æ–½å±‚ (Infrastructure Layer)                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚  â”‚ External        â”‚    â”‚ Persistence     â”‚    â”‚ Repository      â”‚                      â”‚
â”‚  â”‚ Clients         â”‚    â”‚ â€¢ Database      â”‚    â”‚ Implementations â”‚                      â”‚
â”‚  â”‚ â€¢ Redis Client  â”‚    â”‚ â€¢ Migrations    â”‚    â”‚ â€¢ UserRepoImpl  â”‚                      â”‚
â”‚  â”‚ â€¢ Neo4j Client  â”‚    â”‚ â€¢ Connections   â”‚    â”‚ â€¢ RBACRepoImpl  â”‚                      â”‚
â”‚  â”‚ â€¢ Weaviate      â”‚    â”‚                 â”‚    â”‚ â€¢ FileRepoImpl  â”‚                      â”‚
â”‚  â”‚ â€¢ MinIO Client  â”‚    â”‚                 â”‚    â”‚                 â”‚                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                   â”‚
â”‚  â”‚ Securities      â”‚                                                                   â”‚
â”‚  â”‚ â€¢ JWT/Auth      â”‚                                                                   â”‚
â”‚  â”‚ â€¢ Password Hash â”‚                                                                   â”‚
â”‚  â”‚ â€¢ Encryption    â”‚                                                                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ğŸ”„ å…±äº«å±‚ (Shared Layer)                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                             â”‚
â”‚  â”‚ Monitoring      â”‚    â”‚ Multi-Tenancy   â”‚                                             â”‚
â”‚  â”‚ â€¢ Metrics       â”‚    â”‚ â€¢ Tenant        â”‚                                             â”‚
â”‚  â”‚ â€¢ Exception     â”‚    â”‚   Context       â”‚                                             â”‚
â”‚  â”‚   Handlers      â”‚    â”‚ â€¢ Isolation     â”‚                                             â”‚
â”‚  â”‚ â€¢ Logging       â”‚    â”‚ â€¢ Validation    â”‚                                             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                                 â”Œâ”€â”€â”€ å¤–éƒ¨æœåŠ¡ â”€â”€â”€â”
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚             â”‚                 â”‚             â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ PostgreSQL   â”‚ â”‚  Redis  â”‚ â”‚    Neo4j        â”‚ â”‚ MinIO   â”‚
            â”‚ (ä¸»æ•°æ®åº“)    â”‚ â”‚ (ç¼“å­˜)   â”‚ â”‚  (çŸ¥è¯†å›¾è°±)     â”‚ â”‚(å¯¹è±¡å­˜å‚¨)â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
                                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                       â”‚  Weaviate   â”‚
                                       â”‚ (å‘é‡æ•°æ®åº“) â”‚
                                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”„ æ•°æ®æµå‘å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    HTTPè¯·æ±‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    ä¸šåŠ¡é€»è¾‘    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å®¢æˆ·ç«¯      â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ â”‚   æ¥å£å±‚      â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ â”‚   åº”ç”¨å±‚      â”‚
â”‚  (Frontend)  â”‚               â”‚  (API Routes) â”‚               â”‚ (Services)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚                              â”‚
                                       â–¼                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    ä¸­é—´ä»¶å¤„ç†   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    é¢†åŸŸè§„åˆ™    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å“åº”è¿”å›    â”‚ â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚   ä¸­é—´ä»¶å±‚    â”‚ â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚   é¢†åŸŸå±‚      â”‚
â”‚              â”‚               â”‚ (Middleware)  â”‚               â”‚ (Domain)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                      â”‚
                                                                      â–¼
                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    æ•°æ®æŒä¹…åŒ–   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                               â”‚   å…±äº«æœåŠ¡    â”‚ â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  åŸºç¡€è®¾æ–½å±‚   â”‚
                               â”‚  (Shared)    â”‚               â”‚(Infrastructure)â”‚
                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ“ DDDé¡¹ç›®ç»“æ„

```
backend/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ ğŸŒ api/                      # å¤–éƒ¨æ¥å£å±‚
â”‚   â”‚   â”œâ”€â”€ endpoints/v1/           # V1 APIç«¯ç‚¹
â”‚   â”‚   â”‚   â”œâ”€â”€ auth_api.py         # è®¤è¯æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ users_api.py        # ç”¨æˆ·æ¥å£  
â”‚   â”‚   â”‚   â”œâ”€â”€ permission_api.py   # æƒé™æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ role_api.py         # è§’è‰²æ¥å£
â”‚   â”‚   â”‚   â””â”€â”€ files_api.py        # æ–‡ä»¶æ¥å£
â”‚   â”‚   â””â”€â”€ v1/                     # è·¯ç”±æ³¨å†Œ
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“± application/              # åº”ç”¨å±‚
â”‚   â”‚   â”œâ”€â”€ services/               # åº”ç”¨æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ email_service.py    # é‚®ä»¶æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ user_service.py     # ç”¨æˆ·æœåŠ¡
â”‚   â”‚   â”‚   â””â”€â”€ rbac_service.py     # RBACæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ middleware/             # åº”ç”¨ä¸­é—´ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ api_cache_service.py     # APIç¼“å­˜
â”‚   â”‚   â”‚   â”œâ”€â”€ rate_limiter_service.py  # é™æµæœåŠ¡
â”‚   â”‚   â”‚   â””â”€â”€ verification_service.py  # éªŒè¯æœåŠ¡
â”‚   â”‚   â””â”€â”€ use_cases/              # ç”¨ä¾‹å±‚
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ¢ domain/                   # é¢†åŸŸå±‚
â”‚   â”‚   â”œâ”€â”€ entities/               # é¢†åŸŸå®ä½“
â”‚   â”‚   â”œâ”€â”€ services/               # é¢†åŸŸæœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ user_domain_service.py    # ç”¨æˆ·é¢†åŸŸæœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ rbac_domain_service.py    # RBACé¢†åŸŸæœåŠ¡
â”‚   â”‚   â”‚   â””â”€â”€ file_domain_service.py    # æ–‡ä»¶é¢†åŸŸæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ repositories/           # é¢†åŸŸä»“å‚¨æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ user_repository.py        # ç”¨æˆ·ä»“å‚¨æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ rbac_repository.py        # RBACä»“å‚¨æ¥å£
â”‚   â”‚   â”‚   â””â”€â”€ file_repository.py        # æ–‡ä»¶ä»“å‚¨æ¥å£
â”‚   â”‚   â””â”€â”€ initialization/         # é¢†åŸŸåˆå§‹åŒ–
â”‚   â”‚       â”œâ”€â”€ admin_init.py       # è¶…ç®¡åˆå§‹åŒ–
â”‚   â”‚       â”œâ”€â”€ rbac_init.py        # RBACåˆå§‹åŒ–
â”‚   â”‚       â””â”€â”€ permissions.py      # æƒé™å®šä¹‰
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ”§ infrastructure/           # åŸºç¡€è®¾æ–½å±‚
â”‚   â”‚   â”œâ”€â”€ persistence/            # æŒä¹…åŒ–
â”‚   â”‚   â”‚   â””â”€â”€ database.py         # æ•°æ®åº“è¿æ¥
â”‚   â”‚   â”œâ”€â”€ clients/                # å¤–éƒ¨æœåŠ¡å®¢æˆ·ç«¯
â”‚   â”‚   â”‚   â”œâ”€â”€ redis_client.py     # Rediså®¢æˆ·ç«¯
â”‚   â”‚   â”‚   â”œâ”€â”€ neo4j_client.py     # Neo4jå®¢æˆ·ç«¯
â”‚   â”‚   â”‚   â”œâ”€â”€ weaviate_client.py  # Weaviateå®¢æˆ·ç«¯
â”‚   â”‚   â”‚   â””â”€â”€ minio_client.py     # MinIOå®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ repositories/           # ä»“å‚¨å®ç°
â”‚   â”‚   â”‚   â”œâ”€â”€ user_repository_impl.py   # ç”¨æˆ·ä»“å‚¨å®ç°
â”‚   â”‚   â”‚   â”œâ”€â”€ rbac_repository_impl.py   # RBACä»“å‚¨å®ç°
â”‚   â”‚   â”‚   â””â”€â”€ file_repository_impl.py   # æ–‡ä»¶ä»“å‚¨å®ç°
â”‚   â”‚   â””â”€â”€ securities/             # å®‰å…¨å®ç°
â”‚   â”‚       â””â”€â”€ security.py         # åŠ å¯†/JWTç­‰
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ”„ shared/                   # å…±äº«å±‚
â”‚   â”‚   â”œâ”€â”€ monitoring/             # ç›‘æ§
â”‚   â”‚   â”‚   â”œâ”€â”€ metrics.py          # æŒ‡æ ‡æ”¶é›†
â”‚   â”‚   â”‚   â””â”€â”€ exception_handlers.py # å¼‚å¸¸å¤„ç†
â”‚   â”‚   â””â”€â”€ multi_tenancy/          # å¤šç§Ÿæˆ·
â”‚   â”‚       â””â”€â”€ tenant.py           # ç§Ÿæˆ·ç®¡ç†
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ¯ core/                     # æ ¸å¿ƒåŸºç¡€
â”‚   â”‚   â”œâ”€â”€ config.py               # é…ç½®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ logging_config.py       # æ—¥å¿—é…ç½®
â”‚   â”‚   â”œâ”€â”€ exceptions.py           # å¼‚å¸¸å®šä¹‰
â”‚   â”‚   â””â”€â”€ banner.py               # å¯åŠ¨æ¨ªå¹…
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ”— middleware/               # ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ tenant_middleware.py    # ç§Ÿæˆ·ä¸­é—´ä»¶
â”‚   â”‚   â””â”€â”€ logging_middleware.py   # æ—¥å¿—ä¸­é—´ä»¶
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“Š models/                   # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ user_models.py          # ç”¨æˆ·æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ tenant_models.py        # ç§Ÿæˆ·æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ org_models.py           # ç»„ç»‡æ¨¡å‹
â”‚   â”‚   â””â”€â”€ file_models.py          # æ–‡ä»¶æ¨¡å‹
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ schemas/                  # APIæ¨¡å¼
â”‚   â”‚   â”œâ”€â”€ user_schemas.py         # ç”¨æˆ·æ¨¡å¼
â”‚   â”‚   â”œâ”€â”€ rbac_schemas.py         # RBACæ¨¡å¼
â”‚   â”‚   â””â”€â”€ file_schemas.py         # æ–‡ä»¶æ¨¡å¼
â”‚   â”‚
â”‚   â”œâ”€â”€ âš™ï¸ tasks/                    # å¼‚æ­¥ä»»åŠ¡
â”‚   â”‚   â””â”€â”€ user_tasks.py           # ç”¨æˆ·ä»»åŠ¡
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ› ï¸ utils/                    # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ deps.py                 # ä¾èµ–æ³¨å…¥
â”‚   â”‚
â”‚   â”œâ”€â”€ celery.py                   # Celeryé…ç½®
â”‚   â””â”€â”€ main.py                     # åº”ç”¨å…¥å£
â”‚
â”œâ”€â”€ alembic/                        # æ•°æ®åº“è¿ç§»
â”œâ”€â”€ docker-data/                    # Dockeræ•°æ®
â”œâ”€â”€ .env*                          # ç¯å¢ƒé…ç½®
â”œâ”€â”€ requirements*.txt               # ä¾èµ–æ–‡ä»¶
â”œâ”€â”€ docker-compose*.yml            # Dockerç¼–æ’
â””â”€â”€ *.sh                           # å¯åŠ¨è„šæœ¬
```

### ğŸ¯ æ¶æ„ç‰¹ç‚¹

- **ğŸ—ï¸ DDDåˆ†å±‚è®¾è®¡**: é¢†åŸŸé©±åŠ¨è®¾è®¡ï¼Œæ¸…æ™°çš„èŒè´£åˆ†ç¦»
- **ğŸ”„ ä¾èµ–å€’ç½®**: é«˜å±‚æ¨¡å—ä¸ä¾èµ–ä½å±‚æ¨¡å—ï¼Œéƒ½ä¾èµ–äºæŠ½è±¡
- **ğŸ¢ é¢†åŸŸéš”ç¦»**: æ¯ä¸ªé¢†åŸŸéƒ½æœ‰ç‹¬ç«‹çš„å®ä½“ã€æœåŠ¡å’Œä»“å‚¨
- **ğŸ”§ åŸºç¡€è®¾æ–½è§£è€¦**: å¤–éƒ¨æœåŠ¡é€šè¿‡æ¥å£æŠ½è±¡ï¼Œæ˜“äºæµ‹è¯•å’Œæ›¿æ¢
- **ğŸ“± åº”ç”¨æœåŠ¡åè°ƒ**: åº”ç”¨å±‚åè°ƒé¢†åŸŸå±‚å’ŒåŸºç¡€è®¾æ–½å±‚
- **ğŸ”„ æ¨ªåˆ‡å…³æ³¨ç‚¹**: ç›‘æ§ã€å¤šç§Ÿæˆ·ç­‰å…±äº«æœåŠ¡ç‹¬ç«‹ç®¡ç†

### ğŸ“Š ç»„ä»¶ä¾èµ–å…³ç³»å›¾

```
                          åº”ç”¨å¯åŠ¨æµç¨‹å›¾
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                     main.py                             â”‚
         â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
         â”‚            â”‚    create_app()             â”‚              â”‚
         â”‚            â”‚  (Application Factory)     â”‚              â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚                             â”‚
                      â–¼                             â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚    setup_middleware()   â”‚    â”‚   register_routes()     â”‚
         â”‚                         â”‚    â”‚                         â”‚
         â”‚ â€¢ SecurityLogging       â”‚    â”‚ â€¢ v1_router            â”‚
         â”‚ â€¢ RequestLogging        â”‚    â”‚ â€¢ system_router        â”‚
         â”‚ â€¢ TenantMiddleware      â”‚    â”‚                         â”‚
         â”‚ â€¢ CORS                  â”‚    â”‚                         â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚                             â”‚
                      â–¼                             â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                 lifespan()                              â”‚
         â”‚         (Startup & Shutdown Management)                 â”‚
         â”‚                                                         â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
         â”‚  â”‚ initialize_ â”‚  â”‚ Redis       â”‚  â”‚ External    â”‚     â”‚
         â”‚  â”‚ system()    â”‚  â”‚ Connection  â”‚  â”‚ Services    â”‚     â”‚
         â”‚  â”‚             â”‚  â”‚             â”‚  â”‚ (Neo4j,     â”‚     â”‚
         â”‚  â”‚ â€¢ RBAC      â”‚  â”‚             â”‚  â”‚ Weaviate,   â”‚     â”‚
         â”‚  â”‚ â€¢ Admin     â”‚  â”‚             â”‚  â”‚ MinIO)      â”‚     â”‚
         â”‚  â”‚ â€¢ Email     â”‚  â”‚             â”‚  â”‚             â”‚     â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                         APIè¯·æ±‚å¤„ç†æµç¨‹å›¾
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Client  â”‚â”€â”€â”€â–¶â”‚ Middleware  â”‚â”€â”€â”€â–¶â”‚ API Router  â”‚â”€â”€â”€â–¶â”‚ Controller  â”‚
    â”‚ Request â”‚    â”‚ â€¢ Security  â”‚    â”‚ â€¢ v1/auth   â”‚    â”‚ â€¢ Auth API  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â€¢ Logging   â”‚    â”‚ â€¢ v1/users  â”‚    â”‚ â€¢ User API  â”‚
                   â”‚ â€¢ Tenant    â”‚    â”‚ â€¢ v1/files  â”‚    â”‚ â€¢ File API  â”‚
                   â”‚ â€¢ CORS      â”‚    â”‚ â€¢ v1/roles  â”‚    â”‚ â€¢ Role API  â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                â”‚
                                                                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Client  â”‚â—€â”€â”€â”€â”‚ Response    â”‚â—€â”€â”€â”€â”‚ Application â”‚â—€â”€â”€â”€â”‚ Domain      â”‚
    â”‚ Responseâ”‚    â”‚ Formatter   â”‚    â”‚ Service     â”‚    â”‚ Service     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â€¢ UserSvc   â”‚    â”‚ â€¢ Business  â”‚
                                      â”‚ â€¢ EmailSvc  â”‚    â”‚   Logic     â”‚
                                      â”‚ â€¢ RBACsvc   â”‚    â”‚ â€¢ Rules     â”‚
                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚                   â”‚
                                              â–¼                   â–¼
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚ Repository  â”‚    â”‚ Cache       â”‚    â”‚ External    â”‚
                           â”‚ â€¢ User      â”‚    â”‚ â€¢ Redis     â”‚    â”‚ Services    â”‚
                           â”‚ â€¢ RBAC      â”‚    â”‚ â€¢ Session   â”‚    â”‚ â€¢ Email     â”‚
                           â”‚ â€¢ File      â”‚    â”‚ â€¢ API       â”‚    â”‚ â€¢ Storage   â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚ Database    â”‚
                           â”‚ â€¢ PostgreSQLâ”‚
                           â”‚ â€¢ Neo4j     â”‚
                           â”‚ â€¢ Weaviate  â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## âœ… å·²å®ŒæˆåŠŸèƒ½

### ğŸ“§ SMTPé‚®ä»¶æœåŠ¡
- **å¤šæœåŠ¡å•†æ”¯æŒ**ï¼šGmailã€QQã€163ã€è…¾è®¯ä¼ä¸šé‚®ã€é˜¿é‡Œäº‘ã€SendGrid
- **é‚®ä»¶æœåŠ¡**ï¼š`app/application/services/email_service.py`
- **éªŒè¯ç å‘é€**ï¼šæ”¯æŒHTMLç¾åŒ–é‚®ä»¶æ¨¡æ¿
- **å¼€å‘æ¨¡å¼**ï¼š`SMTP_ENABLED=false` æ—¶éªŒè¯ç æ˜¾ç¤ºåœ¨æ§åˆ¶å°

### ğŸ‘‘ è¶…çº§ç®¡ç†å‘˜ç³»ç»Ÿ
- **åˆå§‹åŒ–è„šæœ¬**ï¼š`app/core/admin_init.py`
- **è‡ªåŠ¨åˆ›å»º**ï¼šé»˜è®¤ç§Ÿæˆ·ã€ç»„ç»‡ã€éƒ¨é—¨ã€è¶…çº§ç®¡ç†å‘˜
- **è§’è‰²åˆ†é…**ï¼šè‡ªåŠ¨åˆ†é…è¶…çº§ç®¡ç†å‘˜è§’è‰²å’Œæ‰€æœ‰æƒé™

### ğŸ”§ ç³»ç»Ÿåˆå§‹åŒ–å·¥å…·
- **åˆå§‹åŒ–è„šæœ¬**ï¼š`init_system.py`
- **åŠŸèƒ½å®Œæ•´**ï¼šRBACç³»ç»Ÿ + è¶…çº§ç®¡ç†å‘˜ä¸€é”®è®¾ç½®

### âš™ï¸ é…ç½®æ–‡ä»¶
- **ç¯å¢ƒå˜é‡**ï¼šå®Œæ•´çš„ `.env.example` é…ç½®ç¤ºä¾‹
- **å¤šé‚®ä»¶é…ç½®**ï¼šè¯¦ç»†çš„SMTPé…ç½®ç¤ºä¾‹

### ğŸš€ ä½¿ç”¨æ–¹æ³•

1. **åˆå§‹åŒ–ç³»ç»Ÿ**
   ```bash
   cd backend
   python init_system.py init
   ```

2. **æ£€æŸ¥ç³»ç»ŸçŠ¶æ€**
   ```bash
   python init_system.py status
   ```

3. **æŸ¥çœ‹é‚®ä»¶é…ç½®ç¤ºä¾‹**
   ```bash
   python init_system.py email-configs
   ```

4. **å¯åŠ¨åº”ç”¨æµ‹è¯•**
   ```bash
   python -m app.main
   ```

5. **æµ‹è¯•è®¤è¯åŠŸèƒ½**
   ```bash
   python test_auth.py
   ```

### ğŸ“ é»˜è®¤è¶…çº§ç®¡ç†å‘˜ä¿¡æ¯
- **é‚®ç®±**ï¼š`admin@chatx.com`
- **ç”¨æˆ·å**ï¼š`superadmin`
- **å¯†ç **ï¼š`ChatX@Admin123!`
- **è§’è‰²**ï¼šè¶…çº§ç®¡ç†å‘˜ï¼ˆæ‹¥æœ‰æ‰€æœ‰æƒé™ï¼‰

### ğŸ”‘ éªŒè¯ç è·å–æ–¹å¼
1. **é‚®ä»¶å‘é€**ï¼ˆSMTP_ENABLED=trueï¼‰ï¼šéªŒè¯ç å‘é€åˆ°é‚®ç®±
2. **æ§åˆ¶å°æ˜¾ç¤º**ï¼ˆSMTP_ENABLED=falseï¼‰ï¼šéªŒè¯ç æ˜¾ç¤ºåœ¨åç«¯æ—¥å¿—ä¸­ï¼Œæ ¼å¼ï¼š`ğŸ”‘ éªŒè¯ç : 123456`

### ğŸ“‹ æµ‹è¯•æ­¥éª¤
1. è¿è¡Œ `python init_system.py` åˆå§‹åŒ–ç³»ç»Ÿ
2. å¯åŠ¨åç«¯æœåŠ¡ `python -m app.main`
3. ä½¿ç”¨æµ‹è¯•è„šæœ¬ `python test_auth.py`
4. ä½¿ç”¨è¶…çº§ç®¡ç†å‘˜è´¦æˆ·ç™»å½•æµ‹è¯•ç®¡ç†åŠŸèƒ½

## ğŸš€ è¶…ç®€å•å¯åŠ¨

### ğŸ“‹ ç¯å¢ƒè¦æ±‚

- **Docker**: ç”¨äºæ•°æ®åº“ç­‰åŸºç¡€æœåŠ¡
- **Conda**: æ¨èç”¨äºPythonç¯å¢ƒç®¡ç†
- **Python**: 3.11+ (Condaä¼šè‡ªåŠ¨å®‰è£…)

### ğŸ¯ ä¸€é”®å¯åŠ¨ (æ™ºèƒ½åŒ–)

```bash
# è¿›å…¥åç«¯ç›®å½•
cd backend

# ğŸš€ é€‰æ‹©å¯åŠ¨æ–¹å¼ (ä»»é€‰å…¶ä¸€):

# æ–¹å¼1: æœ¬åœ°å¼€å‘ç¯å¢ƒ (æ¨è)
./dev-start.sh
# âœ… è‡ªåŠ¨åˆ›å»ºCondaç¯å¢ƒ (chatx-backend)
# âœ… è‡ªåŠ¨å®‰è£…æ‰€æœ‰ä¾èµ–
# âœ… è‡ªåŠ¨å¯åŠ¨DockeræœåŠ¡  
# âœ… è‡ªåŠ¨è¿è¡Œæ•°æ®åº“è¿ç§»
# âœ… è‡ªåŠ¨åˆå§‹åŒ–RBACæƒé™ç³»ç»Ÿ
# âœ… è‡ªåŠ¨åˆ›å»ºè¶…çº§ç®¡ç†å‘˜è´¦æˆ·
# âœ… è‡ªåŠ¨æµ‹è¯•é‚®ä»¶æœåŠ¡è¿æ¥
# âœ… å¯åŠ¨FastAPIåº”ç”¨ (http://localhost:8000)

# æ–¹å¼2: å®Œæ•´Dockeréƒ¨ç½²
./start.sh  
# âœ… å®Œæ•´å®¹å™¨åŒ–éƒ¨ç½²
# âœ… åŒ…å«Nginxè´Ÿè½½å‡è¡¡
# âœ… ç”Ÿäº§çº§é…ç½®
# âœ… è®¿é—®åœ°å€: http://localhost
```

### âœ¨ å¯åŠ¨å®Œæˆåè·å¾—

**ğŸ” ç®¡ç†å‘˜è´¦æˆ·**:
- é‚®ç®±: `admin@chatx.com`
- ç”¨æˆ·å: `superadmin`  
- å¯†ç : `ChatX@Admin123!`

**ğŸ“Š é‡è¦åœ°å€**:
- APIæ–‡æ¡£: http://localhost:8000/docs (dev) æˆ– http://localhost/docs (docker)
- å¥åº·æ£€æŸ¥: http://localhost:8000/health (dev) æˆ– http://localhost/health (docker)
- ç³»ç»Ÿä¿¡æ¯: http://localhost:8000/system/info

### ğŸ”§ å¯é€‰æ“ä½œ

```bash
# å•ç‹¬æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
python init_system.py status

# é‡æ–°åˆå§‹åŒ–ç³»ç»Ÿ
python init_system.py init

# æŸ¥çœ‹é‚®ä»¶é…ç½®é€‰é¡¹
python init_system.py email-configs

# æµ‹è¯•è®¤è¯åŠŸèƒ½
python test_auth.py
```

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡é…ç½®

é¡¹ç›®æ”¯æŒå¤šç¯å¢ƒé…ç½®ï¼š

- `.env` - ç”Ÿäº§ç¯å¢ƒé…ç½®
- `.env.dev` - å¼€å‘ç¯å¢ƒé…ç½®  
- `.env.example` - é…ç½®æ¨¡æ¿

ä¸»è¦é…ç½®é¡¹ï¼š

```bash
# æ•°æ®åº“é…ç½®
DATABASE_URL=postgresql://user:password@localhost:5433/chatx_db
REDIS_URL=redis://localhost:6380/0

# æœåŠ¡ç«¯å£ (æ”¯æŒè‡ªå®šä¹‰é¿å…å†²çª)
POSTGRES_PORT=5433
REDIS_PORT=6380
MINIO_PORT=9000
NEO4J_BOLT_PORT=7687
WEAVIATE_PORT=8080

# å®‰å…¨é…ç½®
SECRET_KEY=your-secret-key
ACCESS_TOKEN_EXPIRE_MINUTES=30

# å¤–éƒ¨æœåŠ¡é…ç½®
MINIO_ENDPOINT=localhost:9000
NEO4J_URL=bolt://localhost:7687
WEAVIATE_URL=http://localhost:8080
```

### æœåŠ¡è¯´æ˜

| æœåŠ¡ | ç«¯å£ | æè¿° |
|------|------|------|
| PostgreSQL | 5433 | ä¸»æ•°æ®åº“ |
| Redis | 6380 | ç¼“å­˜å’Œä¼šè¯ |
| MinIO | 9000/9001 | å¯¹è±¡å­˜å‚¨ |
| Neo4j | 7474/7687 | çŸ¥è¯†å›¾è°± |
| Weaviate | 8080 | å‘é‡æ•°æ®åº“ |

## ğŸ”¨ å¼€å‘æŒ‡å—

### ä»£ç è§„èŒƒ

é¡¹ç›®ä½¿ç”¨ä»¥ä¸‹å·¥å…·ç¡®ä¿ä»£ç è´¨é‡ï¼š

```bash
# ä»£ç æ ¼å¼åŒ–
black app/

# å¯¼å…¥æ’åº
isort app/

# ä»£ç æ£€æŸ¥
flake8 app/

# ç±»å‹æ£€æŸ¥
mypy app/
```

### æ•°æ®åº“è¿ç§»

```bash
# åˆ›å»ºè¿ç§»
alembic revision --autogenerate -m "æè¿°"

# åº”ç”¨è¿ç§»
alembic upgrade head

# æŸ¥çœ‹è¿ç§»å†å²
alembic history
```

### æµ‹è¯•

```bash
# è¿è¡Œæµ‹è¯•
pytest

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
pytest --cov=app tests/
```

## ğŸ“š API æ–‡æ¡£

å¯åŠ¨åº”ç”¨åï¼Œè®¿é—®ä»¥ä¸‹åœ°å€æŸ¥çœ‹ API æ–‡æ¡£ï¼š

- **Swagger UI**: <http://localhost:8000/docs>
- **ReDoc**: <http://localhost:8000/redoc>
- **OpenAPI JSON**: <http://localhost:8000/openapi.json>

### ä¸»è¦ API ç«¯ç‚¹

- `POST /auth/login` - ç”¨æˆ·ç™»å½•
- `POST /auth/register` - ç”¨æˆ·æ³¨å†Œ
- `GET /users/me` - è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
- `POST /files/upload` - æ–‡ä»¶ä¸Šä¼ 
- `GET /files/` - æ–‡ä»¶åˆ—è¡¨

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ç«¯å£å†²çª**
   - é—®é¢˜ï¼šPostgreSQL ç«¯å£ 5432 å·²è¢«å ç”¨
   - è§£å†³ï¼šä¿®æ”¹ `.env` æ–‡ä»¶ä¸­çš„ç«¯å£é…ç½®

2. **æœåŠ¡å¯åŠ¨å¤±è´¥**
   - æ£€æŸ¥ Docker æœåŠ¡çŠ¶æ€ï¼š`docker-compose ps`
   - æŸ¥çœ‹æœåŠ¡æ—¥å¿—ï¼š`docker-compose logs <service_name>`

3. **æ•°æ®åº“è¿æ¥å¤±è´¥**
   - ç¡®ä¿ PostgreSQL æœåŠ¡æ­£å¸¸è¿è¡Œ
   - æ£€æŸ¥ç¯å¢ƒå˜é‡ä¸­çš„æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²

4. **è™šæ‹Ÿç¯å¢ƒé—®é¢˜**
   - **Condaç¯å¢ƒé—®é¢˜**
     ```bash
     # æ£€æŸ¥condaæ˜¯å¦å®‰è£…
     conda --version
     
     # æŸ¥çœ‹æ‰€æœ‰ç¯å¢ƒ
     conda env list
     
     # æ¿€æ´»chatx-backendç¯å¢ƒ
     conda activate chatx-backend
     
     # åˆ é™¤å¹¶é‡æ–°åˆ›å»ºç¯å¢ƒ
     conda env remove -n chatx-backend
     conda create -n chatx-backend python=3.11 -y
     ```
   - **ä¼ ç»Ÿè™šæ‹Ÿç¯å¢ƒé—®é¢˜**
     - ç¡®ä¿æ¿€æ´»äº†æ­£ç¡®çš„è™šæ‹Ÿç¯å¢ƒ
     - é‡æ–°å®‰è£…ä¾èµ–ï¼š`pip install -r requirements.txt`

### æ—¥å¿—æŸ¥çœ‹

```bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
docker-compose logs -f app

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker-compose logs -f postgres
docker-compose logs -f redis

# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡çŠ¶æ€
docker-compose ps
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»º Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ†˜ æ”¯æŒ

å¦‚æœæ‚¨é‡åˆ°é—®é¢˜æˆ–æœ‰ç–‘é—®ï¼Œè¯·ï¼š

1. æŸ¥çœ‹æœ¬æ–‡æ¡£çš„æ•…éšœæ’é™¤éƒ¨åˆ†
2. æœç´¢ç°æœ‰çš„ Issues
3. åˆ›å»ºæ–°çš„ Issue å¹¶æä¾›è¯¦ç»†ä¿¡æ¯

---

**Happy Coding! ğŸ‰**